<main>
  <div class="container mx-auto">
    <header class="w-full flex justify-between">
      <h1 class="text-2xl font-bold text-label"> Transações </h1>

      <button mat-flat-button color="primary" class="w-max" (click)="createFinance()"> Adicionar Transação <i icon="arrow_up_arrow_down"></i> </button>
    </header>

    @if( !loading() ){
      <section class="container-tablet mt-6">
        <table mat-table [dataSource]="dataSource()">

          <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef> Descrição </th>
            <td mat-cell *matCellDef="let element"> {{ element.description }} </td>
          </ng-container>

          <ng-container matColumnDef="type">
            <th mat-header-cell *matHeaderCellDef> Tipo </th>
            <td mat-cell *matCellDef="let element">
              <span class="!w-max px-3 flex items-center gap-2 py-1 rounded-full {{element.type === 'INCOME' ? 'bg-primary8 text-primary' : 'bg-Red8 text-Red'}}">
                <i icon="circle_small" class="flex justify-center items-center"></i> {{ element.type | status }}
              </span>
            </td>
          </ng-container>

          <ng-container matColumnDef="category">
            <th mat-header-cell *matHeaderCellDef> Categoria </th>
            <td mat-cell *matCellDef="let element"> {{ element.category_obj?.name || '-' }} </td>
          </ng-container>

          <ng-container matColumnDef="value_installment">
            <th mat-header-cell *matHeaderCellDef> Valor </th>
            <td mat-cell *matCellDef="let element"> {{ element.value_installment | currency }} </td>
          </ng-container>

          <ng-container matColumnDef="expiry_date">
            <th mat-header-cell *matHeaderCellDef> Data </th>
            <td mat-cell *matCellDef="let element" class="opacity-50">
              <div class="!w-max flex justify-start items-center gap-1">
                <span>  {{ element.expiry_date | date: 'dd' }} </span>
                <span> de </span>
                <span class="capitalize"> {{ element.expiry_date | date: 'MMMM' }} </span>
                <span> {{ element.expiry_date | date: 'yyyy' }} </span>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef> Status </th>
            <td mat-cell *matCellDef="let element"> {{ element.value_installment | currency }} </td>
          </ng-container>

          <ng-container matColumnDef="options">
            <th mat-header-cell *matHeaderCellDef>  </th>
            <td mat-cell *matCellDef="let element">
              <div class="w-full flex justify-end items-center gap-2">
                <button mat-mini-fab class="!bg-transparent !p-1 !size-8">
                  <i icon="pen_to_square" class="cursor-pointer p-1"></i>
                </button>

                <button mat-mini-fab class="!bg-transparent !p-1 !size-8">
                  <i icon="trash" class="cursor-pointer"></i>
                </button>
              </div>
            </td>
          </ng-container>

          <tr *matNoDataRow>
            <td colspan="100%">
              <p>Nenhum resultado encontrado</p>
            </td>
          </tr>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </section>
    }
  </div>
</main>
